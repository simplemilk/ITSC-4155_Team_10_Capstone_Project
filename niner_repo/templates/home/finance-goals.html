{% extends 'base.html' %}

{% block title %}Financial Goals - Niner Finance{% endblock %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/finance-goals.css') }}">

<div class="goals-container">
    <!-- Header Section -->
    <div class="goals-header">
        <h1><i class="fas fa-target me-2"></i>Financial Goals</h1>
        <p class="lead">Set and track your financial goals with target dates</p>
        <button class="btn btn-primary" onclick="showAddGoalModal()">
            <i class="fas fa-plus me-2"></i>Add New Goal
        </button>
    </div>

    <!-- Goals Grid -->
    <div class="goals-grid" id="goals-grid">
        <!-- Goals will be populated dynamically -->
        <div class="loading-message">
            <i class="fas fa-spinner fa-spin me-2"></i>Loading your goals...
        </div>
    </div>

    <!-- Financial Summary Split View -->
    <div class="financial-split-view">
        <!-- Costs Side -->
        <div class="split-side costs-side">
            <h2 class="side-header">Current Expenses</h2>
            <div class="amount-display">
                $<span id="total-costs">0.00</span>
            </div>
            <div class="percentage">
                <span id="costs-percentage">0</span>% of Total
            </div>
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="costs-progress"></div>
                </div>
            </div>
            <div class="details-list" id="costs-list">
                <!-- Costs details will be populated dynamically -->
            </div>
            <div class="loading-overlay">
                <div class="loading-spinner"></div>
            </div>
        </div>

        <!-- Savings Side -->
        <div class="split-side savings-side">
            <h2 class="side-header">Current Savings</h2>
            <div class="amount-display">
                $<span id="total-savings">0.00</span>
            </div>
            <div class="percentage">
                <span id="savings-percentage">0</span>% of Total
            </div>
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="savings-progress"></div>
                </div>
            </div>
            <div class="details-list" id="savings-list">
                <!-- Savings details will be populated dynamically -->
            </div>
            <div class="loading-overlay">
                <div class="loading-spinner"></div>
            </div>
        </div>
    </div>
</div>

<!-- Add Goal Modal -->
<div class="modal fade" id="addGoalModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-target me-2"></i>Add New Financial Goal
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="addGoalForm">
                    <div class="mb-3">
                        <label for="goalName" class="form-label">Goal Name</label>
                        <input type="text" class="form-control" id="goalName" required 
                               placeholder="e.g., Emergency Fund, New Laptop, Vacation">
                    </div>
                    
                    <div class="mb-3">
                        <label for="goalDescription" class="form-label">Description (Optional)</label>
                        <textarea class="form-control" id="goalDescription" rows="2" 
                                  placeholder="Brief description of your goal..."></textarea>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="targetAmount" class="form-label">Target Amount</label>
                                <div class="input-group">
                                    <span class="input-group-text">$</span>
                                    <input type="number" class="form-control" id="targetAmount" 
                                           min="0" step="0.01" required placeholder="0.00">
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="currentAmount" class="form-label">Current Amount</label>
                                <div class="input-group">
                                    <span class="input-group-text">$</span>
                                    <input type="number" class="form-control" id="currentAmount" 
                                           min="0" step="0.01" value="0.00" placeholder="0.00">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="targetDate" class="form-label">Target Date</label>
                        <input type="date" class="form-control" id="targetDate" required>
                    </div>
                    
                    <div class="mb-3">
                        <label for="goalCategory" class="form-label">Category</label>
                        <select class="form-control" id="goalCategory">
                            <option value="emergency">Emergency Fund</option>
                            <option value="education">Education</option>
                            <option value="travel">Travel</option>
                            <option value="technology">Technology</option>
                            <option value="housing">Housing</option>
                            <option value="transportation">Transportation</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    
                    <div class="mb-3">
                        <label for="monthlyContribution" class="form-label">Planned Monthly Contribution</label>
                        <div class="input-group">
                            <span class="input-group-text">$</span>
                            <input type="number" class="form-control" id="monthlyContribution" 
                                   min="0" step="0.01" placeholder="0.00">
                        </div>
                        <div class="form-text" id="contributionHelp"></div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="saveGoal()">
                    <i class="fas fa-save me-2"></i>Save Goal
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Goal Card Template -->
<template id="goal-card-template">
    <div class="goal-card">
        <div class="goal-header">
            <div class="goal-icon">
                <i class="goal-icon-class"></i>
            </div>
            <div class="goal-info">
                <h4 class="goal-name"></h4>
                <p class="goal-description"></p>
            </div>
            <div class="goal-actions">
                <button class="btn btn-sm btn-outline-primary" onclick="editGoal(this)" title="Edit Goal">
                    <i class="fas fa-edit"></i>
                </button>
                <button class="btn btn-sm btn-outline-success" onclick="addContribution(this)" title="Add Contribution">
                    <i class="fas fa-plus"></i>
                </button>
                <button class="btn btn-sm btn-outline-danger" onclick="deleteGoal(this)" title="Delete Goal">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        </div>
        
        <div class="goal-progress">
            <div class="progress-info">
                <span class="current-amount"></span>
                <span class="target-amount"></span>
            </div>
            <div class="progress mb-2">
                <div class="progress-bar goal-progress-bar"></div>
            </div>
            <div class="progress-percentage"></div>
        </div>
        
        <div class="goal-timeline">
            <div class="timeline-item">
                <i class="fas fa-calendar-alt"></i>
                <span class="timeline-label">Target Date:</span>
                <span class="target-date"></span>
            </div>
            <div class="timeline-item">
                <i class="fas fa-clock"></i>
                <span class="timeline-label">Days Left:</span>
                <span class="days-left"></span>
            </div>
            <div class="timeline-item">
                <i class="fas fa-dollar-sign"></i>
                <span class="timeline-label">Monthly Need:</span>
                <span class="monthly-need"></span>
            </div>
        </div>
        
        <div class="goal-status">
            <span class="status-badge"></span>
        </div>
    </div>
</template>

{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/finance-goals.js') }}"></script>
{% endblock %}