{% extends 'base.html' %}

{% block title %}Profile & Settings - Niner Finance{% endblock %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/profile.css') }}">

<div class="profile-container">
    <!-- Header Section -->
    <div class="profile-header">
        <h1><i class="fas fa-user-cog me-2"></i>Profile & Settings</h1>
        <p class="lead">Customize your account and preferences</p>
    </div>

    <div class="row">
        <!-- Profile Information -->
        <div class="col-lg-4">
            <div class="profile-card">
                <div class="profile-avatar">
                    <div class="avatar-circle">
                        <i class="fas fa-user"></i>
                    </div>
                    <button class="btn btn-sm btn-outline-primary mt-2" onclick="changeAvatar()">
                        <i class="fas fa-camera me-1"></i>Change Photo
                    </button>
                </div>
                <div class="profile-info">
                    <h4 id="profile-username">{{ g.user['username'] if g.user else 'User' }}</h4>
                    <p class="text-muted" id="profile-email">{{ g.user['email'] if g.user else 'user@example.com' }}</p>
                    <p class="profile-description" id="profile-description">UNCC Student</p>
                </div>
            </div>

            <!-- Quick Stats -->
            <div class="stats-card">
                <h5>Account Statistics</h5>
                <div class="stat-item">
                    <span class="stat-label">Member Since:</span>
                    <span class="stat-value" id="member-since">October 2023</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Goals Created:</span>
                    <span class="stat-value" id="goals-count">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Transactions:</span>
                    <span class="stat-value" id="transactions-count">0</span>
                </div>
            </div>
        </div>

        <!-- Settings Panel -->
        <div class="col-lg-8">
            <div class="settings-panel">
                <!-- Account Settings Tab -->
                <div class="settings-section active" id="account-section">
                    <h5><i class="fas fa-user me-2"></i>Account Information</h5>
                    
                    <form id="account-form" class="settings-form">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="username" class="form-label">Username</label>
                                    <input type="text" class="form-control" id="username" value="{{ g.user['username'] if g.user else '' }}">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="email" class="form-label">Email Address</label>
                                    <input type="email" class="form-control" id="email" value="{{ g.user['email'] if g.user else '' }}">
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="description" class="form-label">Description</label>
                            <textarea class="form-control" id="description" rows="3" placeholder="Tell us about yourself...">UNCC Student</textarea>
                        </div>
                        
                        <div class="mb-3">
                            <label for="phone" class="form-label">Phone Number (Optional)</label>
                            <input type="tel" class="form-control" id="phone" placeholder="+1 (555) 123-4567">
                        </div>
                        
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save me-2"></i>Save Changes
                        </button>
                    </form>
                </div>

                <!-- Security Settings -->
                <div class="settings-section mt-4">
                    <h5><i class="fas fa-shield-alt me-2"></i>Security Settings</h5>
                    
                    <form id="security-form" class="settings-form">
                        <div class="mb-3">
                            <label for="current-password" class="form-label">Current Password</label>
                            <input type="password" class="form-control" id="current-password" placeholder="Enter current password">
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="new-password" class="form-label">New Password</label>
                                    <input type="password" class="form-control" id="new-password" placeholder="Enter new password">
                                    <div class="password-strength" id="password-strength"></div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="confirm-password" class="form-label">Confirm New Password</label>
                                    <input type="password" class="form-control" id="confirm-password" placeholder="Confirm new password">
                                </div>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn btn-warning">
                            <i class="fas fa-key me-2"></i>Update Password
                        </button>
                    </form>
                </div>

                <!-- Preferences Settings -->
                <div class="settings-section mt-4">
                    <h5><i class="fas fa-cog me-2"></i>Preferences</h5>
                    
                    <form id="preferences-form" class="settings-form">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="currency" class="form-label">Preferred Currency</label>
                                    <select class="form-control" id="currency">
                                        <option value="USD">US Dollar ($)</option>
                                        <option value="EUR">Euro (€)</option>
                                        <option value="GBP">British Pound (£)</option>
                                        <option value="CAD">Canadian Dollar (C$)</option>
                                        <option value="AUD">Australian Dollar (A$)</option>
                                        <option value="JPY">Japanese Yen (¥)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="timezone" class="form-label">Timezone</label>
                                    <select class="form-control" id="timezone">
                                        <option value="EST">Eastern Standard Time</option>
                                        <option value="CST">Central Standard Time</option>
                                        <option value="MST">Mountain Standard Time</option>
                                        <option value="PST">Pacific Standard Time</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="date-format" class="form-label">Date Format</label>
                            <select class="form-control" id="date-format">
                                <option value="MM/DD/YYYY">MM/DD/YYYY</option>
                                <option value="DD/MM/YYYY">DD/MM/YYYY</option>
                                <option value="YYYY-MM-DD">YYYY-MM-DD</option>
                            </select>
                        </div>
                        
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-save me-2"></i>Save Preferences
                        </button>
                    </form>
                </div>

                <!-- Notification Settings -->
                <div class="settings-section mt-4">
                    <h5><i class="fas fa-bell me-2"></i>Notification Settings</h5>
                    
                    <form id="notifications-form" class="settings-form">
                        <div class="notification-group">
                            <h6>Financial Goals</h6>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="goal-achievement" checked>
                                <label class="form-check-label" for="goal-achievement">
                                    Goal Achievement Notifications
                                    <small class="text-muted d-block">Get notified when you reach your savings goals</small>
                                </label>
                            </div>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="goal-progress" checked>
                                <label class="form-check-label" for="goal-progress">
                                    Goal Progress Updates
                                    <small class="text-muted d-block">Weekly updates on your goal progress</small>
                                </label>
                            </div>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="goal-reminders">
                                <label class="form-check-label" for="goal-reminders">
                                    Goal Deadline Reminders
                                    <small class="text-muted d-block">Reminders when goal deadlines approach</small>
                                </label>
                            </div>
                        </div>

                        <div class="notification-group">
                            <h6>Budget & Spending</h6>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="budget-alerts" checked>
                                <label class="form-check-label" for="budget-alerts">
                                    Budget Limit Alerts
                                    <small class="text-muted d-block">Get notified when approaching budget limits</small>
                                </label>
                            </div>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="weekly-summary">
                                <label class="form-check-label" for="weekly-summary">
                                    Weekly Financial Summary
                                    <small class="text-muted d-block">Weekly overview of your financial activity</small>
                                </label>
                            </div>
                        </div>

                        <div class="notification-group">
                            <h6>Security</h6>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="login-alerts" checked>
                                <label class="form-check-label" for="login-alerts">
                                    Login Alerts
                                    <small class="text-muted d-block">Get notified of new login attempts</small>
                                </label>
                            </div>
                        </div>
                        
                        <div class="mt-3">
                            <button type="button" class="btn btn-info me-2" onclick="testNotifications()">
                                <i class="fas fa-test-tube me-2"></i>Test Notifications
                            </button>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save me-2"></i>Save Notification Settings
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Danger Zone -->
                <div class="settings-section danger-zone mt-4">
                    <h5><i class="fas fa-exclamation-triangle me-2"></i>Danger Zone</h5>
                    
                    <div class="danger-actions">
                        <div class="danger-item">
                            <h6>Export Data</h6>
                            <p class="text-muted">Download all your financial data as a CSV file</p>
                            <button class="btn btn-outline-info" onclick="exportData()">
                                <i class="fas fa-download me-2"></i>Export Data
                            </button>
                        </div>
                        
                        <div class="danger-item">
                            <h6>Delete Account</h6>
                            <p class="text-muted">Permanently delete your account and all data</p>
                            <button class="btn btn-danger" onclick="confirmDeleteAccount()">
                                <i class="fas fa-trash me-2"></i>Delete Account
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Test Notification Modal -->
<div class="modal fade" id="testNotificationModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Test Notifications</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p>Choose a notification type to test:</p>
                <div class="d-grid gap-2">
                    <button class="btn btn-outline-success" onclick="showTestNotification('goal')">
                        <i class="fas fa-bullseye me-2"></i>Goal Achievement
                    </button>
                    <button class="btn btn-outline-warning" onclick="showTestNotification('budget')">
                        <i class="fas fa-exclamation-triangle me-2"></i>Budget Alert
                    </button>
                    <button class="btn btn-outline-info" onclick="showTestNotification('reminder')">
                        <i class="fas fa-clock me-2"></i>Goal Reminder
                    </button>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/profile.js') }}"></script>
{% endblock %}